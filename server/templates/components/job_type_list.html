{% if job_types.is_empty() %}
<div class="card">
    <p class="text-secondary">No job types configured yet. Click "Add Job Type" to get started.</p>
</div>
{% else %}
<div class="grid grid-2">
    {% for jt in job_types %}
    <div class="card" id="job-type-{{ jt.id }}">
        <div class="card-header">
            <h3 class="card-title">{{ jt.name }}</h3>
            <span class="badge badge-info">
                {% if jt.execution_type == "shell" %}Shell
                {% else if jt.execution_type == "docker" %}Docker
                {% else if jt.execution_type == "systemd" %}systemd
                {% else if jt.execution_type == "composite" %}Composite
                {% endif %}
            </span>
        </div>

        {% match jt.description %}
        {% when Some with (d) %}
        <p class="text-secondary">{{ d }}</p>
        {% when None %}
        {% endmatch %}

        <!-- Required Capabilities -->
        {% if !jt.required_capabilities.is_empty() %}
        <div class="mb-2">
            <strong class="text-secondary">Required Capabilities:</strong>
            <div class="flex gap-1 flex-wrap mt-1">
                {% for cap in jt.required_capabilities %}
                <span class="badge badge-warning" style="font-size: 0.75rem;">
                    {{ cap }}
                </span>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Command Templates Count -->
        <div class="flex-between mb-2" style="align-items: center;">
            <span class="text-secondary">
                <strong>Command Templates:</strong> {{ jt.command_template_count }}
            </span>
            <button hx-get="/job-types/{{ jt.id }}/command-templates/new"
                    hx-target="#command-template-form-container"
                    hx-swap="innerHTML"
                    class="btn btn-xs btn-primary"
                    style="padding: 2px 6px; font-size: 0.75rem;"
                    title="Add Command Template">
                <i data-lucide="plus" style="width: 12px; height: 12px;"></i>
            </button>
        </div>

        <div class="flex gap-2 mt-2">
            <button hx-get="/job-types/{{ jt.id }}"
                    hx-target="#job-type-form-container"
                    hx-swap="innerHTML"
                    class="btn btn-sm btn-secondary">
                <i data-lucide="eye" style="width: 14px; height: 14px;"></i> View
            </button>

            <button hx-get="/job-types/{{ jt.id }}/edit"
                    hx-target="#job-type-form-container"
                    hx-swap="innerHTML"
                    class="btn btn-sm btn-secondary">
                <i data-lucide="pencil" style="width: 14px; height: 14px;"></i> Edit
            </button>

            {% if jt.job_template_count == 0 %}
            <button hx-delete="/job-types/{{ jt.id }}"
                    hx-target="#job-type-{{ jt.id }}"
                    hx-swap="outerHTML"
                    hx-confirm="Delete job type '{{ jt.name }}'?"
                    class="btn btn-sm btn-danger">
                <i data-lucide="trash-2" style="width: 14px; height: 14px;"></i> Delete
            </button>
            {% else %}
            <button disabled
                    class="btn btn-sm btn-secondary"
                    title="Cannot delete - in use by {{ jt.job_template_count }} job template(s)">
                <i data-lucide="trash-2" style="width: 14px; height: 14px;"></i> Delete
            </button>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
