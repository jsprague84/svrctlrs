{% if notifications.is_empty() %}
<div class="card">
    <p class="text-secondary">No notification backends configured yet. Click "Add Notification Backend" to get started.</p>
</div>
{% else %}
<div class="grid grid-2">
    {% for notification in notifications %}
    <div class="card" id="notification-{{ notification.id }}">
        <div class="card-header">
            <h3 class="card-title">{{ notification.name }}</h3>
            <span class="badge {% if notification.enabled %}badge-success{% else %}badge-warning{% endif %}">
                {% if notification.enabled %}Enabled{% else %}Disabled{% endif %}
            </span>
        </div>
        
        <p class="text-secondary">
            <strong>Type:</strong> {{ notification.channel_type_display }}<br>
            <strong>Endpoint:</strong> {{ notification.endpoint }}
        </p>
        
        <div id="test-result-{{ notification.id }}" class="mb-2"></div>

        <!-- Test notification form -->
        <form hx-post="/api/v1/notifications/{{ notification.id }}/test"
              hx-target="#test-result-{{ notification.id }}"
              hx-swap="innerHTML"
              class="flex gap-2 mb-2 align-items-end">
            {% if notification.channel_type == "ntfy" %}
            <div class="form-group mb-0" style="flex: 1;">
                <label for="test-topic-{{ notification.id }}" class="text-sm">Test Topic:</label>
                <input type="text"
                       name="topic"
                       id="test-topic-{{ notification.id }}"
                       placeholder="Leave empty for default topic"
                       class="form-control form-control-sm">
            </div>
            {% endif %}
            <button type="submit"
                    class="btn btn-primary btn-sm"
                    {% if notification.enabled %}{% else %}disabled{% endif %}>
                <i data-lucide="flask-conical" style="width: 14px; height: 14px;"></i> Test
            </button>
        </form>

        <div class="flex gap-2">
            <button hx-get="/settings/notifications/{{ notification.id }}/edit"
                    hx-target="#notification-form-container"
                    hx-swap="innerHTML"
                    class="btn btn-secondary btn-sm">
                Edit
            </button>

            <button hx-delete="/settings/notifications/{{ notification.id }}"
                    hx-target="#notification-{{ notification.id }}"
                    hx-swap="outerHTML"
                    hx-confirm="Delete notification backend '{{ notification.name }}'?"
                    class="btn btn-danger btn-sm">
                Delete
            </button>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

