<div class="card">
    <h2>{% match tag %}{% when Some with (_) %}Edit{% when None %}Add{% endmatch %} Tag</h2>

    {% match error %}
    {% when Some with (e) %}
    <div class="alert alert-error">{{ e }}</div>
    {% when None %}
    {% endmatch %}

    {% match tag %}
    {% when Some with (t) %}
    <form hx-put="/tags/{{ t.id }}"
          hx-target="#tag-list"
          hx-swap="innerHTML">

        <div class="form-group">
            <label for="name">Tag Name *</label>
            <input type="text"
                   id="name"
                   name="name"
                   value="{{ t.name }}"
                   placeholder="production"
                   required>
            <small class="text-secondary">Use lowercase, no spaces (e.g., production, staging, web-servers)</small>
        </div>

        <div class="form-group">
            <label for="color">Color *</label>
            <div class="flex gap-2 align-center">
                <input type="color"
                       id="color"
                       name="color"
                       value="{{ t.color }}"
                       required
                       style="width: 60px; height: 40px; border-radius: 4px; border: 1px solid var(--border);">
                <div class="flex-1">
                    <div class="badge" style="background-color: {{ t.color }}; color: #fff;">
                        {{ t.name }}
                    </div>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label for="description">Description (optional)</label>
            <textarea id="description"
                      name="description"
                      rows="2"
                      placeholder="Brief description of this tag's purpose">{% match t.description %}{% when Some with (d) %}{{ d }}{% when None %}{% endmatch %}</textarea>
        </div>

        <div class="flex gap-2">
            <button type="submit" class="btn btn-primary">
                <i data-lucide="save" style="width: 16px; height: 16px;"></i> Save
            </button>
            <button type="button"
                    onclick="document.getElementById('tag-form-container').innerHTML = ''"
                    class="btn btn-secondary">
                Cancel
            </button>
        </div>
    </form>
    {% when None %}
    <form hx-post="/tags"
          hx-target="#tag-list"
          hx-swap="innerHTML">

        <div class="form-group">
            <label for="name">Tag Name *</label>
            <input type="text"
                   id="name"
                   name="name"
                   placeholder="production"
                   required>
            <small class="text-secondary">Use lowercase, no spaces (e.g., production, staging, web-servers)</small>
        </div>

        <div class="form-group">
            <label for="color">Color *</label>
            <div class="flex gap-2 align-center">
                <input type="color"
                       id="color"
                       name="color"
                       value="#7aa2f7"
                       required
                       style="width: 60px; height: 40px; border-radius: 4px; border: 1px solid var(--border);">
                <div class="flex-1">
                    <span class="text-secondary">Select a color for this tag</span>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label for="description">Description (optional)</label>
            <textarea id="description"
                      name="description"
                      rows="2"
                      placeholder="Brief description of this tag's purpose"></textarea>
        </div>

        <div class="flex gap-2">
            <button type="submit" class="btn btn-primary">
                <i data-lucide="save" style="width: 16px; height: 16px;"></i> Save
            </button>
            <button type="button"
                    onclick="document.getElementById('tag-form-container').innerHTML = ''"
                    class="btn btn-secondary">
                Cancel
            </button>
        </div>
    </form>
    {% endmatch %}
</div>
